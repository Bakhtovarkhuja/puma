define(["gga.gtmEvent","gga.baseEventBody","helper.intersectionObserver","gga.generatePromoEventBody","gga.generateItemFromAnalyticsData",],function(gtmEvent,baseEventBody,intersectionObserver,generatePromoEventBody,generateItemFromAnalyticsData,){return function(){const domElements=document.querySelectorAll(".full-bleed-hero");if(!domElements.length){return;}
const eventName="view_promotion";const baseEventBodyObj=baseEventBody(eventName);intersectionObserver({domElements,observerCallback,});function observerCallback(entries,observer){const promoEvents=[];entries.forEach(entry=>{if(entry.intersectionRatio>0.5){const items=[];if(window.analyticsPageData&&window.analyticsPageData.category&&window.analyticsPageData.category.products&&typeof window.analyticsPageData.category.products==="object"&&Object.keys(window.analyticsPageData.category.products).length){for(const[key,product]of Object.entries(window.analyticsPageData.category.products)){items.push(generateItemFromAnalyticsData(product));}}
promoEvents.push(generatePromoEventBody(entry.target,items));observer.unobserve(entry.target);}});if(promoEvents.length){promoEvents.forEach(eventObj=>{gtmEvent(eventName,Object.assign(baseEventBodyObj,eventObj));});}}};});