define(['jquery','underscore','Magento_Customer/js/customer-data'],function($,_,customerData){'use strict';let customer=customerData.get('customer');let cart=customerData.get('cart');return{startTracking:function(){if(!window.pumastore){window.addEventListener('pumastoreReady',this.initTrackers);return;}
this.initTrackers();},initTrackers:function(){let cartQty;if(window.$customerCart){setCartCount(window.$customerCart);}
cart.subscribe(setCartCount);function setCartCount(cart){if(typeof cart!=="object"){console.error('setCartCount should be obj',cart);return;}
if(cartQty===cart.summary_count){return;}
let initial=!cartQty;cartQty=cart.summary_count;pumastore.set('cartCount',{count:cartQty,initial:initial});}
if(window.$currentCustomer){setUserStatus(window.$currentCustomer);}
customer.subscribe(setUserStatus);function setUserStatus(customerObj){if(typeof customerObj!=='object'){console.error('setUserStatus should be obj',customerObj);return;}
pumastore.set('userStatus',{loggedIn:customerObj.hasOwnProperty('fullname')});}}};});