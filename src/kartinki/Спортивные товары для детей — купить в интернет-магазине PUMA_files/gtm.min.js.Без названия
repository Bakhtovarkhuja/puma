define(['uiComponent','jquery','uiRegistry'],function(Component,$,registry){'use strict'
return Component.extend({defaults:{lazyData:null,statefull:{lazyData:true},tracks:{lazyData:true}},initialize:function(){this._super()
this.events()
if(this.lazyData){this.push(this.lazyData)
this.lazyData=null}},events:function(){$(document).on('click','[data-gtm-click]',this.onClick.bind(this))},onClick:function(ev){const $el=$(ev.currentTarget)
const data=$el.data('gtm-click')
const isLazy=$el.data('gtm-lazy')
const triggerPage=$el.data('gtm-trigger-page')
if(!data){return}
if(triggerPage){const storage=registry.get('localStorage')
storage.set(triggerPage,{lazyData:data})}else if(isLazy){this.lazyData=data}else{this.push(data)}},push:function(data){const dataLayer=$.extend({},this.impression,data)
window.dataLayer=window.dataLayer||[]
window.dataLayer.push(dataLayer)}})})