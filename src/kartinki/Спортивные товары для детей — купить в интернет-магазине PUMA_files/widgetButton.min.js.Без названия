define(["helper.isCurrentPageUrlFromList","subscribe.blackListUrls","helper.isLocalStorageFlagExpired","js/gga/ga4Custom/newsletterImpression",],function(isCurrentPageUrlFromList,blackListUrls,isLocalStorageFlagExpired,newsletterImpression,){return function(popupToShow){if(window.$isPolituch){return;}
const historySessionName="subscriptionWidgetClose";const $widgetContainer=document.querySelector("[data-popup-widget-container]");const $widgetCloseBtn=document.querySelector("[data-popup-widget-close]");if($widgetContainer&&$widgetCloseBtn){$widgetContainer.addEventListener("click",e=>{popupToShow.modal('show');newsletterImpression('popup');});$widgetCloseBtn.addEventListener("click",e=>{if(e.currentTarget===$widgetCloseBtn){e.stopPropagation();$widgetContainer.style.display="none";setHistoryFlag();}});isCanShow();}
function isCanShow(){if(!isBlockedPage()&&!isValidUserSession()){$widgetContainer.style.display="block";}}
function isBlockedPage(){return isCurrentPageUrlFromList(blackListUrls);}
function isValidUserSession(){return isLocalStorageFlagExpired({key:historySessionName,durationTime:1800000,});}
function setHistoryFlag(){window.localStorage.setItem(historySessionName,Date.now().toString());}};});