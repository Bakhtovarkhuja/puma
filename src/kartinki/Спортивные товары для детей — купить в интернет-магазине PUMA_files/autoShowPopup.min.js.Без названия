define(["helper.isCurrentPageUrlFromList","subscribe.blackListUrls","helper.isLocalStorageFlagExpired","js/gga/ga4Custom/newsletterImpression",],function(isCurrentPageUrlFromList,blackListUrls,isLocalStorageFlagExpired,newsletterImpression,){return function($modalElement){if(!$modalElement){console.error("No $modalElement pass",$modalElement);return;}
if(window.$isPolituch){return;}
const intervalVal=25000;const historySessionName="subscriptionPopupClose";const checkInterval=setInterval(isCanShow,intervalVal);$modalElement.addEventListener("hide.eins.modal",setUserHistoryCloseDefaultPopup);function isCanShow(){if(!isBlockedPage()&&!isValidUserSession()&&!isSubscribedUser()&&!isOpenEinsModal()){if(!isOpenEsputnikSubscribePopup()&&!isModalPopupShow()){$modalElement.modal("show");newsletterImpression('popup');clearInterval(checkInterval);}}else{clearInterval(checkInterval);}}
function isOpenEsputnikSubscribePopup(){const popupElement=document.querySelector(".cl-dialog");return Boolean(popupElement);}
function isModalPopupShow(){const popupElement=document.querySelector(".modal-popup._show");return Boolean(popupElement);}
function isOpenEinsModal(){return Boolean(window.einsModal?.getOpenModals().length);}
function isSubscribedUser(){return Boolean(window.customer&&window.customer.isSubscribe);}
function isValidUserSession(){return isLocalStorageFlagExpired({key:historySessionName,durationTime:1800000,});}
function isBlockedPage(){return isCurrentPageUrlFromList(blackListUrls);}
function setUserHistoryCloseDefaultPopup(event){window.localStorage.setItem(historySessionName,Date.now().toString());}};});