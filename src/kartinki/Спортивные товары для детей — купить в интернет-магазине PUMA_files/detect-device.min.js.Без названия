define(['jquery','matchSize','browser'],function($,matchSize){'use strict'
var timeout,delay=500
return{settings:{$body:$('body')},init:function(){this.addBodyClass()
this.checkPlatform()
this.checkState()
this.bindEvents()},addBodyClass:function(){this.settings.$body.toggleClass('desktop',matchSize().desktop)
this.settings.$body.toggleClass('tablet',matchSize().tablet)
this.settings.$body.toggleClass('mobile',matchSize().mobile)
if(!('ontouchstart'in document.documentElement))this.settings.$body.addClass('no-touch')
this.settings.$body.triggerHandler('init-state')},bindEvents:function(){$(window).on('resize',this.resize.bind(this))},checkPlatform:function(){var platform=$.browser.platform
if(platform){this.settings.$body.addClass(platform)}
if($.browser.name&&$.browser.versionNumber){this.settings.$body.addClass($.browser.name)
this.settings.$body.addClass($.browser.name+$.browser.versionNumber)}
if(navigator.platform&&navigator.platform.toUpperCase().indexOf('WIN')>=0){this.settings.$body.addClass('windows')}
this.settings.$body.toggleClass('android',navigator.userAgent.match(/Android/i)!==null)
this.settings.$body.toggleClass('firefox',navigator.userAgent.match(/Firefox/i)!==null)
this.settings.$body.toggleClass('safari',navigator.userAgent.match(/Safari/i)!==null&&navigator.userAgent.match(/Chrome/i)===null)},checkState:function(){this.settings.$body.data('old-state',this.detectState())},detectState:function(){var state=matchSize()
if(state.desktop){return'desktop'}
if(state.tablet){return'tablet'}
return'mobile'},resize:function(){clearTimeout(timeout)
timeout=setTimeout(function(){this.addBodyClass()
this.settings.$body.data('old-state',this.settings.$body.data('state'))
this.settings.$body.data('state',this.detectState())
if(this.settings.$body.data('old-state')!==this.settings.$body.data('state')){this.settings.$body.triggerHandler('change-state')}
this.settings.$body.triggerHandler('resize-body')}.bind(this),delay)}}})