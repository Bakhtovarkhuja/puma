define(['jquery','ko','Magento_Customer/js/customer-data','mage/cookies'],function($,ko,customerData){var visitor=ko.observable(null);var getVisitorData=function(customer){return{'customer':{'ID':customer.id,'anonymous':!$.mage.cookies.get('adobe_launch_registered'),'authenticated':window.isLoggedIn,'registered':$.mage.cookies.get('adobe_launch_registered')==1,'location':customer.location,'sessionID':customer.sessionID,'email':customer.email}};};if(localStorage.getItem('analyticsCustomer')){var customer=JSON.parse(localStorage.getItem('analyticsCustomer'));visitor(getVisitorData(customer));return visitor;}
var customer=customerData.get('customer');customer.subscribe(function(customer){visitor(getVisitorData(customer));});if($.isEmptyObject(customer())){customerData.invalidate(['customer']);}else{visitor(getVisitorData(customer()));}
return visitor;});