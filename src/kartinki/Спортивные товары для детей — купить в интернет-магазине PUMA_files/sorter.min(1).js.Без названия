define(["jquery","ko","pageLoader","gga.event.sortSelected",'js/gga/ga4Custom/sort',],function($,ko,pageLoader,sortSelected,sortGA4Event,){"use strict";return{sorter:function(url){pageLoader.showLoading();$.get({url:url,cache:true}).always(function(){pageLoader.hideLoading();}).done(function(response){this.updateUrl(url);$(document).triggerHandler("layer:update",response);$(document).triggerHandler("catalog:update",response);}.bind(this)).fail(function(){});},updateUrl:function(url){if(!url){return;}
const urlObj=new URL(url);if(urlObj.search){const productOrder=urlObj.searchParams.get("product_list_order")||"position";const productDirection=urlObj.searchParams.get("product_list_dir")||"asc";sortSelected({domevent:productOrder,domlabel:productDirection,});sortGA4Event(`${ productOrder }:${ productDirection }`);}
if("pushState"in history){history.replaceState("","",url);}}};});