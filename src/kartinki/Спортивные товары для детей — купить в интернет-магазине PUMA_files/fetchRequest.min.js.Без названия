define(['js/helper/showMessage','mage/translate','pageLoader',],function(showMessage,$t,pageLoader,){return function(requestData={url:'',requestOptions:{},},domElem){const{url,requestOptions,configOptions={isShowLoading:false,}}=requestData;if(!url){console.error('Should be url set',url);return;}
const needRedirect=requestOptions?.redirect==='follow';let $domElem=null;if(configOptions.isShowLoading){if(domElem){$domElem=$(domElem);}
pageLoader.showLoading($domElem);}
return fetch(url,Object.assign(requestOptions,{method:'POST',})).then(response=>{if(needRedirect&&response.redirected){window.location.href=response.url;return{responseStatus:'redirected',response,}}
return response.json();}).then(result=>result).catch((error)=>{console.error(error);showMessage([{type:'error',text:error?.message||$t('Error')},]);return error;}).finally(()=>{if(configOptions.isShowLoading){pageLoader.hideLoading($domElem);}});};});