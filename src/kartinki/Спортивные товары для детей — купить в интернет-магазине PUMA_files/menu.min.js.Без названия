define(['jquery','underscore'],function($,_){'use strict'
return{init:function(){this.pushData(this.getData());this.events();},events:function(){var webComponentsEventBus=window.webComponentsEventBus||{}
if(_.isEmpty(webComponentsEventBus)){return}
webComponentsEventBus.addEventListener('navigation-menu-click',this.saveData.bind(this))
webComponentsEventBus.addEventListener('navigation-menu-view',this.pushViewData.bind(this))},prepareData:function(event){var lbl=event.type.indexOf('click')!==-1?'::'+event.detail.level:''
return{event:event.type,eventCategory:event.detail.label,eventLabel:event.detail.type+lbl}},saveData:function(event){var dataLayer=window.dataLayer||[],data=this.prepareData(event)
localStorage.setItem('menu',JSON.stringify(data))},pushData:function(data){if(data){window.dataLayer=window.dataLayer||[]
window.dataLayer.push(data)}},getData:function(){var menuData=localStorage.getItem('menu')
if(menuData===undefined){return false}
localStorage.removeItem('menu')
return JSON.parse(menuData)},pushViewData:function(event){this.pushData(this.prepareData(event))}}})