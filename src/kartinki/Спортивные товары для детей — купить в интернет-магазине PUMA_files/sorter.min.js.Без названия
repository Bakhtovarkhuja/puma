define(['uiComponent','ko','jquery','lodash','Magento_Catalog/js/action/list/toolbar/sorter'],function(Component,ko,$,_,sorterAction){'use strict'
return Component.extend({lockPlaceholder:true,initialize:function(){this._super()
this.label=ko.observable(this.label)
this.value=ko.observable('')},rendered:function(){$(document).triggerHandler('sorter:initialized')},changeOption:function(event){this.lockPlaceholder=false
var $option=$(event.currentTarget).find('option:selected')
this.select({label:$option.text(),dir:$option.data('dir'),code:$option.data('code')})},clickHandler:function(event){var $elem=$(event.currentTarget);this.select({label:$elem.data('label'),dir:$elem.data('dir'),code:$elem.data('code')})},select:function(value){var data={}
if(this.isActive(value)){return}
this.label(value.label)
data[this.ORDER_PARAM_NAME]=value.code
data[this.DIRECTION_PARAM_NAME]=value.dir
sorterAction.sorter(this.getUrl(data))},remove:function(event){event.stopPropagation()
var data={}
this.label('')
data[this.ORDER_PARAM_NAME]=this.defaultOrder
data[this.DIRECTION_PARAM_NAME]=this.defaultDirection
sorterAction.sorter(this.getUrl(data))},getUrl:function(data){var location=window.location,params=location.search!==''?$.parseQuery(location.search):{}
delete params.p
params=$.extend(params,data)
params=$.param(params)
return location.origin+location.pathname+'?'+params},isActive:function(value){return this.label()===value.label},isActiveOnMobile:function(value){return((!this.lockPlaceholder||(value.code!=='position'&&value.code!=='relevance'))&&this.isActive(value))}})})